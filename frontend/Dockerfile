# This is the newer version
FROM node:22-alpine

ARG VITE_STRAPI_URL
ENV VITE_STRAPI_URL=$VITE_STRAPI_URL

ARG VITE_API_URL
ENV VITE_API_URL=$VITE_API_URL

ARG VITE_AUTHORITY
ENV VITE_AUTHORITY=$VITE_AUTHORITY

ARG VITE_AUDIENCE
ENV VITE_AUDIENCE=$VITE_AUDIENCE

ARG VITE_REDIRECT_URI
ENV VITE_REDIRECT_URI=$VITE_REDIRECT_URI

ARG VITE_BOOKING_SDK
ENV VITE_BOOKING_SDK=$VITE_BOOKING_SDK

ARG VITE_BOOKING_URL
ENV VITE_BOOKING_URL=$VITE_BOOKING_URL

ARG VITE_BOOKING_LOGIN
ENV VITE_BOOKING_LOGIN=$VITE_BOOKING_LOGIN

ARG VITE_TRANSLATE_URL
ENV VITE_TRANSLATE_URL=$VITE_TRANSLATE_URL

ARG VITE_TRANSLATE_API_KEY
ENV VITE_TRANSLATE_API_KEY=$VITE_TRANSLATE_API_KEY

ARG VITE_MATOMO_JS
ENV VITE_MATOMO_JS=$VITE_MATOMO_JS

WORKDIR /app
COPY package.json .
COPY package-lock.json .

RUN npm ci
RUN npm i -g serve

COPY .. .

RUN npm run build

EXPOSE 3000

CMD [ "serve", "-s", "dist", "-p", "3000" ]
